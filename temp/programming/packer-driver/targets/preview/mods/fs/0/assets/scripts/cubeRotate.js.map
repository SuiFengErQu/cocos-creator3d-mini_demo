{"version":3,"sources":["file:///D:/CocosProject/testDemo/cocos3d20211013/20211014/demolist2/assets/scripts/cubeRotate.ts"],"names":["_decorator","Component","systemEvent","SystemEvent","v3","Quat","quat","ccclass","property","CubeRotate","start","on","EventType","TOUCH_MOVE","touchMove","t","e","delta","getDelta","axis","y","x","rad","length","quat_cur","node","getRotation","qu","console","log","normalize","rotateAround","setRotation"],"mappings":";;;;;;;;;;;;AACSA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,E,OAAAA,E;AAAIC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,I,OAAAA,I;;;;;;;AAClEC,MAAAA,O,GAAsBP,U,CAAtBO,O;AAASC,MAAAA,Q,GAAaR,U,CAAbQ,Q;AAEjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;4BAEaC,U,WADZF,OAAO,CAAC,YAAD,C;;;;;;;;;AAEJ;AACA;AAEA;AACA;AACA;eAEAG,K,GAAA,iBAAS;AACL;AACA;AACAR,UAAAA,WAAW,CAACS,EAAZ,CAAeR,WAAW,CAACS,SAAZ,CAAsBC,UAArC,EAAiD,KAAKC,SAAtD,EAAiE,IAAjE;AACH,S,CAED;AACA;AACA;;;eACAA,S,GAAA,mBAAUC,CAAV,EAAYC,CAAZ,EACA;AACI;AAEA;AACA,cAAIC,KAAK,GAAID,CAAC,CAACE,QAAF,EAAb;AACA,cAAMC,IAAI,GAAGf,EAAE,CAAC,CAACa,KAAK,CAACG,CAAR,EAAWH,KAAK,CAACI,CAAjB,EAAoB,CAApB,CAAf,CALJ,CAK2C;;AACvC,cAAMC,GAAG,GAAGL,KAAK,CAACM,MAAN,KAAiB,IAA7B,CANJ,CAMuC;;AACnC,cAAMC,QAAQ,GAAG,KAAKC,IAAL,CAAUC,WAAV,EAAjB,CAPJ,CAO8C;;AAC1C,cAAIC,EAAE,GAAGrB,IAAI,EAAb;AACAsB,UAAAA,OAAO,CAACC,GAAR,CAAaV,IAAI,CAACW,SAAL,EAAb;AAEAzB,UAAAA,IAAI,CAAC0B,YAAL,CAAkBJ,EAAlB,EAAsBH,QAAtB,EAAgCL,IAAI,CAACW,SAAL,EAAhC,EAAkDR,GAAlD,EAXJ,CAW4D;AACxD;;AACA,eAAKG,IAAL,CAAUO,WAAV,CAAsBL,EAAtB;AAEH,S;;;QAjC2B1B,S;AAoChC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sourcesContent":["\nimport { _decorator, Component, Node, systemEvent, SystemEvent, v3, Quat, quat, EventTouch } from 'cc';\nconst { ccclass, property } = _decorator;\n\n/**\n * Predefined variables\n * Name = CubeRotate\n * DateTime = Wed Nov 03 2021 10:37:06 GMT+0800 (中国标准时间)\n * Author = fywxk\n * FileBasename = cubeRotate.ts\n * FileBasenameNoExtension = cubeRotate\n * URL = db://assets/scripts/cubeRotate.ts\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/zh/\n *\n */\n//  触摸cube实现 绕轴旋转\n@ccclass('CubeRotate')\nexport class CubeRotate extends Component {\n    // [1]\n    // dummy = '';\n\n    // [2]\n    // @property\n    // serializableDummy = 0;\n\n    start () {\n        // [3]\n        // 监听全局touchmove\n        systemEvent.on(SystemEvent.EventType.TOUCH_MOVE, this.touchMove, this);\n    }\n\n    // update (deltaTime: number) {\n    //     // [4]\n    // }\n    touchMove(t,e:EventTouch)\n    {\n        // console.log(e.getDelta());\n        \n        // 获取触点距离上一次事件移动的距离对象，对象包含 x 和 y 属性。\n        let delta =  e.getDelta();\n        const axis = v3(-delta.y, delta.x, 0); //旋转轴，根据相似三角形求出\n        const rad = delta.length() * 1e-2; //旋转角度\n        const quat_cur = this.node.getRotation(); //当前的四元数\n        let qu = quat()\n        console.log( axis.normalize());\n        \n        Quat.rotateAround(qu, quat_cur, axis.normalize(), rad); //当面的四元数绕旋转轴旋转\n        // 旋转后的结果 / 当前的四元数 / 旋转轴 / 旋转四元数\n        this.node.setRotation(qu);\n\n    }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/zh/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/zh/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/zh/scripting/life-cycle-callbacks.html\n */\n"]}