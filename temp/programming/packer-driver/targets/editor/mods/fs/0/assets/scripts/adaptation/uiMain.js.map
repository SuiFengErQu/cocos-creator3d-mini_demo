{"version":3,"sources":["file:///D:/CocosProject/testDemo/cocos3d20211013/20211014/demolist2/assets/scripts/adaptation/uiMain.ts"],"names":["_decorator","Component","Node","view","sys","Widget","ResolutionPolicy","ccclass","property","UiMain","onLoad","design","getDesignResolutionSize","isMobile","setDesignResolutionSize","width","height","FIXED_HEIGHT","FIXED_WIDTH","updateSizeFit","_this","setResizeCallback","rect","getVisibleSize","wi","node","getComponent","right","left","top","bottom","updateAlignment","widget","pcBg","target"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, Node, view, sys, Widget, ResolutionPolicy } from 'cc';\nconst { ccclass, property } = _decorator;\n\n/**\n * Predefined variables\n * Name = UiMain\n * DateTime = Thu Nov 18 2021 15:41:25 GMT+0800 (中国标准时间)\n * Author = fywxk\n * FileBasename = uiMain.ts\n * FileBasenameNoExtension = uiMain\n * URL = db://assets/scripts/adaptation/uiMain.ts\n * ManualUrl = https://docs.cocos.com/creator/3.3/manual/zh/\n *\n */\n \n@ccclass('UiMain')\nexport class UiMain extends Component {\n    // [1]\n    // dummy = '';\n\n    // [2]\n    // @property\n    // serializableDummy = 0;\n    @property(Node)\n    pcBg: Node = null;\n\n    onLoad() {\n\n        let design = view.getDesignResolutionSize(); // 设计分辨率，。就是设置的 750 1334 根据不同端做适配\n        if(!sys.isMobile)\n        {// pc端\n            view.setDesignResolutionSize(design.width, design.height, ResolutionPolicy.FIXED_HEIGHT);\n        }\n        else\n        {// 手机端\n            view.setDesignResolutionSize(design.width, design.height, ResolutionPolicy.FIXED_WIDTH);\n        }\n\n        this.updateSizeFit();\n        let _this = this;\n        // 监听浏览器窗口大小变化\n        view.setResizeCallback(function () {\n            _this.updateSizeFit();\n            // rect.left, rect.top, rect.width, rect.height (像素值)\n        });\n    }\n     // 根据浏览器窗口变化适配\n     updateSizeFit() {\n        var rect = view.getVisibleSize();// 获取实际显示的尺寸\n        var design = view.getDesignResolutionSize();// 获取设计分辨率\n        let wi = this.node.getComponent(Widget);\n        // 设置手机端和pc端canvas的显示位置，在pc是横屏的，但是canvas应该是中间的手机位置。所以要左右减 \n        //  实际屏幕宽度的一半减去手机屏宽的一半，就是pcBg距离Canvas左侧的距离\n        if (!sys.isMobile) { // pc端加背景图，实现中间显示手机界面\n            wi.right = rect.width/2-(rect.height*design.width/design.height)/2;\n            wi.left = rect.width/2-(rect.height*design.width/design.height)/2;\n            wi.top = 0;\n            wi.bottom = 0;\n            wi.updateAlignment();\n        }\n        else\n        { // 手机端 屏幕宽度高，就是canvas的宽高。，距离是0就可以\n            wi.right = 0;\n            wi.left = 0;\n            wi.top = 0;\n            wi.bottom = 0;\n            wi.updateAlignment();\n        }\n        // pc大背景全屏显示，大背景图平铺到pc上，相对于canvas 左右都是负的宽的的一半\n        var widget = this.pcBg.getComponent(Widget)\n        widget.right = -rect.width/2;\n        widget.left = -rect.width/2;\n        widget.top = 0;\n        widget.bottom = 0;\n        widget.target = this.node;\n        widget.updateAlignment();\n    }\n}\n\n/**\n * [1] Class member could be defined like this.\n * [2] Use `property` decorator if your want the member to be serializable.\n * [3] Your initialization goes here.\n * [4] Your update function goes here.\n *\n * Learn more about scripting: https://docs.cocos.com/creator/3.3/manual/zh/scripting/\n * Learn more about CCClass: https://docs.cocos.com/creator/3.3/manual/zh/scripting/ccclass.html\n * Learn more about life-cycle callbacks: https://docs.cocos.com/creator/3.3/manual/zh/scripting/life-cycle-callbacks.html\n */\n"]}